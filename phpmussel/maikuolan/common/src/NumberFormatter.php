<?php
/**
 * Number formatter (last modified: 2025.07.02).
 *
 * This file is a part of the "common classes package", utilised by a number of
 * packages and projects, including CIDRAM and phpMussel.
 * @link https://github.com/Maikuolan/Common
 *
 * License: GNU/GPLv2
 * @see LICENSE.txt
 *
 * "COMMON CLASSES PACKAGE", as well as the earliest iteration and deployment
 * of this class, COPYRIGHT 2019 and beyond by Caleb Mazalevskis (Maikuolan).
 */

namespace Maikuolan\Common;

class NumberFormatter extends CommonAbstract
{
    /**
     * @var string Identifies the conversion set to use.
     */
    public $ConversionSet = 'Western';

    /**
     * @var string Identifies the separator to use for separating number groups.
     */
    public $GroupSeparator = ',';

    /**
     * @var int Identifies the group size to use for separating number groups.
     */
    public $GroupSize = 3;

    /**
     * @var int Identifies the offset to use when counting the size of number groups.
     */
    public $GroupOffset = 0;

    /**
     * @var string Identifies the decimal separator to use.
     */
    public $DecimalSeparator = '.';

    /**
     * @var int Identifies the base system of the target format.
     */
    public $Base = 10;

    /**
     * @var int Maximum ratio or degrees possible when calculating fractions.
     */
    private $MaxDegrees = 9999;

    /**
     * @var array Conversion set for Hindu-Arabic or Western Arabic numerals.
     *      The array here is intentionally empty, because it's our default
     *      "conversion set" to use (keeping it here in order to be explicit).
     */
    private $Western = [];

    /**
     * @var array Conversion set for Eastern Arabic numerals.
     */
    private $Eastern = [
        '0' => 'Ù ',
        '1' => 'Ù¡',
        '2' => 'Ù¢',
        '3' => 'Ù£',
        '4' => 'Ù¤',
        '5' => 'Ù¥',
        '6' => 'Ù¦',
        '7' => 'Ù§',
        '8' => 'Ù¨',
        '9' => 'Ù©'
    ];

    /**
     * @var array Conversion set for Persian/Urdu numerals (Eastern Arabic variant).
     */
    private $Persian = [
        '0' => 'Û°',
        '1' => 'Û±',
        '2' => 'Û²',
        '3' => 'Û³',
        '4' => 'Û´',
        '5' => 'Ûµ',
        '6' => 'Û¶',
        '7' => 'Û·',
        '8' => 'Û¸',
        '9' => 'Û¹'
    ];

    /**
     * @var array Conversion set for Nagari/Bengali/Bangla numerals.
     */
    private $Nagari = [
        '0' => 'à§¦',
        '1' => 'à§§',
        '2' => 'à§¨',
        '3' => 'à§©',
        '4' => 'à§ª',
        '5' => 'à§«',
        '6' => 'à§¬',
        '7' => 'à§­',
        '8' => 'à§®',
        '9' => 'à§¯'
    ];

    /**
     * @var array Conversion set for Devanagari numerals (used by Hindi, Marathi, etc).
     */
    private $Devanagari = [
        '0' => 'à¥¦',
        '1' => 'à¥§',
        '2' => 'à¥¨',
        '3' => 'à¥©',
        '4' => 'à¥ª',
        '5' => 'à¥«',
        '6' => 'à¥¬',
        '7' => 'à¥­',
        '8' => 'à¥®',
        '9' => 'à¥¯'
    ];

    /**
     * @var array Conversion set for Gujarati numerals.
     */
    private $Gujarati = [
        '0' => 'à«¦',
        '1' => 'à«§',
        '2' => 'à«¨',
        '3' => 'à«©',
        '4' => 'à«ª',
        '5' => 'à««',
        '6' => 'à«¬',
        '7' => 'à«­',
        '8' => 'à«®',
        '9' => 'à«¯'
    ];

    /**
     * @var array Conversion set for Gurmukhi/Punjabi numerals.
     */
    private $Gurmukhi = [
        '0' => 'à©¦',
        '1' => 'à©§',
        '2' => 'à©¨',
        '3' => 'à©©',
        '4' => 'à©ª',
        '5' => 'à©«',
        '6' => 'à©¬',
        '7' => 'à©­',
        '8' => 'à©®',
        '9' => 'à©¯'
    ];

    /**
     * @var array Conversion set for Kannada numerals.
     */
    private $Kannada = [
        '0' => 'à³¦',
        '1' => 'à³§',
        '2' => 'à³¨',
        '3' => 'à³©',
        '4' => 'à³ª',
        '5' => 'à³«',
        '6' => 'à³¬',
        '7' => 'à³­',
        '8' => 'à³®',
        '9' => 'à³¯'
    ];

    /**
     * @var array Conversion set for Telugu numerals.
     */
    private $Telugu = [
        '0' => 'à±¦',
        '1' => 'à±§',
        '2' => 'à±¨',
        '3' => 'à±©',
        '4' => 'à±ª',
        '5' => 'à±«',
        '6' => 'à±¬',
        '7' => 'à±­',
        '8' => 'à±®',
        '9' => 'à±¯'
    ];

    /**
     * @var array Conversion set for Burmese numerals.
     */
    private $Burmese = [
        '0' => 'á€',
        '1' => 'á',
        '2' => 'á‚',
        '3' => 'áƒ',
        '4' => 'á„',
        '5' => 'á…',
        '6' => 'á†',
        '7' => 'á‡',
        '8' => 'áˆ',
        '9' => 'á‰'
    ];

    /**
     * @var array Conversion set for Khmer numerals.
     */
    private $Khmer = [
        '0' => 'áŸ ',
        '1' => 'áŸ¡',
        '2' => 'áŸ¢',
        '3' => 'áŸ£',
        '4' => 'áŸ¤',
        '5' => 'áŸ¥',
        '6' => 'áŸ¦',
        '7' => 'áŸ§',
        '8' => 'áŸ¨',
        '9' => 'áŸ©'
    ];

    /**
     * @var array Conversion set for Thai numerals.
     */
    private $Thai = [
        '0' => 'à¹',
        '1' => 'à¹‘',
        '2' => 'à¹’',
        '3' => 'à¹“',
        '4' => 'à¹”',
        '5' => 'à¹•',
        '6' => 'à¹–',
        '7' => 'à¹—',
        '8' => 'à¹˜',
        '9' => 'à¹™'
    ];

    /**
     * @var array Conversion set for Lao numerals.
     */
    private $Lao = [
        '0' => 'à»',
        '1' => 'à»‘',
        '2' => 'à»’',
        '3' => 'à»“',
        '4' => 'à»”',
        '5' => 'à»•',
        '6' => 'à»–',
        '7' => 'à»—',
        '8' => 'à»˜',
        '9' => 'à»™'
    ];

    /**
     * @var array Conversion set for Mayan numerals (unlikely to ever be
     *      needed, but serves as an amusing "easter egg" to demonstrate
     *      the capabilities of the class).
     */
    private $Mayan = [
        '0' => 'ð‹ ',
        '1' => 'ð‹¡',
        '2' => 'ð‹¢',
        '3' => 'ð‹£',
        '4' => 'ð‹¤',
        '5' => 'ð‹¥',
        '6' => 'ð‹¦',
        '7' => 'ð‹§',
        '8' => 'ð‹¨',
        '9' => 'ð‹©',
        'a' => 'ð‹ª',
        'b' => 'ð‹«',
        'c' => 'ð‹¬',
        'd' => 'ð‹­',
        'e' => 'ð‹®',
        'f' => 'ð‹¯',
        'g' => 'ð‹°',
        'h' => 'ð‹±',
        'i' => 'ð‹²',
        'j' => 'ð‹³'
    ];

    /**
     * @var array Conversion set for Japanese numerals.
     */
    private $Japanese = [
        'UpperLimit' => 1.0E+24,
        'LowerLimit' => 1.0E-11,
        '+0' => '',
        '-+0' => '',
        '-1' => 'ä¸€',
        '1' => '',
        '2' => 'äºŒ',
        '3' => 'ä¸‰',
        '4' => 'å››',
        '5' => 'äº”',
        '6' => 'å…­',
        '7' => 'ä¸ƒ',
        '8' => 'å…«',
        '9' => 'ä¹',
        '^0+1' => 'ä¸€',
        '^1' => 'å',
        '^2' => 'ç™¾',
        '^3' => 'åƒ',
        '^4' => 'ä¸‡',
        '^5' => 'åä¸‡',
        '^6' => 'ç™¾ä¸‡',
        '^7' => 'åƒä¸‡',
        '^8' => 'å„„',
        '^9' => 'åå„„',
        '^10' => 'ç™¾å„„',
        '^11' => 'åƒå„„',
        '^12' => 'å…†',
        '^13' => 'åå…†',
        '^14' => 'ç™¾å…†',
        '^15' => 'åƒå…†',
        '^16' => 'äº¬',
        '^17' => 'åäº¬',
        '^18' => 'ç™¾äº¬',
        '^19' => 'åƒäº¬',
        '^20' => 'åž“',
        '^21' => 'ååž“',
        '^22' => 'ç™¾åž“',
        '^23' => 'åƒåž“',
        '^-1' => 'åˆ†',
        '^-2' => 'åŽ˜',
        '^-3' => 'æ¯›',
        '^-4' => 'ç³¸',
        '^-5' => 'å¿½',
        '^-6' => 'å¾®',
        '^-7' => 'ç¹Š',
        '^-8' => 'æ²™',
        '^-9' => 'å¡µ',
        '^-10' => 'åŸƒ'
    ];

    /**
     * @var array Conversion set for Tamil numerals.
     */
    private $Tamil = [
        '.' => true,
        'UpperLimit' => 1.0E+24,
        'LowerLimit' => 1,
        '+0' => '',
        '1' => '',
        '2' => 'à¯¨',
        '3' => 'à¯©',
        '4' => 'à¯ª',
        '5' => 'à¯«',
        '6' => 'à¯¬',
        '7' => 'à¯­',
        '8' => 'à¯®',
        '9' => 'à¯¯',
        '^0+1' => 'à¯§',
        '^1' => 'à¯°',
        '^2' => 'à¯±',
        '^3' => 'à¯²',
        '^4' => 'à¯°à¯²',
        '^5' => 'à¯±à¯²',
        '^6' => 'à¯²à¯²',
        '^7' => 'à¯°à¯²à¯²',
        '^8' => 'à¯±à¯²à¯²',
        '^9' => 'à¯²à¯²à¯²',
        '^10' => 'à¯°à¯²à¯²à¯²',
        '^11' => 'à¯±à¯²à¯²à¯²',
        '^12' => 'à¯²à¯²à¯²à¯²',
        '^13' => 'à¯°à¯²à¯²à¯²à¯²',
        '^14' => 'à¯±à¯²à¯²à¯²à¯²',
        '^15' => 'à¯²à¯²à¯²à¯²à¯²',
        '^16' => 'à¯°à¯²à¯²à¯²à¯²à¯²',
        '^17' => 'à¯±à¯²à¯²à¯²à¯²à¯²',
        '^18' => 'à¯²à¯²à¯²à¯²à¯²à¯²',
        '^19' => 'à¯°à¯²à¯²à¯²à¯²à¯²à¯²',
        '^20' => 'à¯±à¯²à¯²à¯²à¯²à¯²à¯²',
        '^21' => 'à¯²à¯²à¯²à¯²à¯²à¯²à¯²',
        '^22' => 'à¯°à¯²à¯²à¯²à¯²à¯²à¯²à¯²',
        '^23' => 'à¯±à¯²à¯²à¯²à¯²à¯²à¯²à¯²'
    ];

    /**
     * @var array Conversion set for Javanese numerals.
     */
    private $Javanese = [
        '0' => 'ê§',
        '1' => 'ê§‘',
        '2' => 'ê§’',
        '3' => 'ê§“',
        '4' => 'ê§”',
        '5' => 'ê§•',
        '6' => 'ê§–',
        '7' => 'ê§—',
        '8' => 'ê§˜',
        '9' => 'ê§™'
    ];

    /**
     * @var array Conversion set for Roman numerals (modern standard form with vinculum).
     */
    private $Roman = [
        '.' => true,
        'UpperLimit' => 3999999,
        'LowerLimit' => 1,
        '0' => '',
        '1' => '',
        '2' => '',
        '3' => '',
        '4' => '',
        '5' => '',
        '6' => '',
        '7' => '',
        '8' => '',
        '9' => '',
        '^0+1' => 'I',
        '^0+2' => 'II',
        '^0+3' => 'III',
        '^0+4' => 'IV',
        '^0+5' => 'V',
        '^0+6' => 'VI',
        '^0+7' => 'VII',
        '^0+8' => 'VIII',
        '^0+9' => 'IX',
        '^1+1' => 'X',
        '^1+2' => 'XX',
        '^1+3' => 'XXX',
        '^1+4' => 'XL',
        '^1+5' => 'L',
        '^1+6' => 'LX',
        '^1+7' => 'LXX',
        '^1+8' => 'LXXX',
        '^1+9' => 'XC',
        '^2+1' => 'C',
        '^2+2' => 'CC',
        '^2+3' => 'CCC',
        '^2+4' => 'CD',
        '^2+5' => 'D',
        '^2+6' => 'DC',
        '^2+7' => 'DCC',
        '^2+8' => 'DCCC',
        '^2+9' => 'CM',
        '^3+1' => 'M',
        '^3+2' => 'MM',
        '^3+3' => 'MMM',
        '^3+4' => 'IÌ…VÌ…',
        '^3+5' => 'VÌ…',
        '^3+6' => 'VÌ…IÌ…',
        '^3+7' => 'VÌ…IÌ…IÌ…',
        '^3+8' => 'VÌ…IÌ…IÌ…IÌ…',
        '^3+9' => 'IÌ…XÌ…',
        '^4+1' => 'XÌ…',
        '^4+2' => 'XÌ…XÌ…',
        '^4+3' => 'XÌ…XÌ…XÌ…',
        '^4+4' => 'XÌ…LÌ…',
        '^4+5' => 'LÌ…',
        '^4+6' => 'LÌ…XÌ…',
        '^4+7' => 'LÌ…XÌ…XÌ…',
        '^4+8' => 'LÌ…XÌ…XÌ…XÌ…',
        '^4+9' => 'XÌ…CÌ…',
        '^5+1' => 'CÌ…',
        '^5+2' => 'CÌ…CÌ…',
        '^5+3' => 'CÌ…CÌ…CÌ…',
        '^5+4' => 'CÌ…DÌ…',
        '^5+5' => 'DÌ…',
        '^5+6' => 'DÌ…CÌ…',
        '^5+7' => 'DÌ…CÌ…CÌ…',
        '^5+8' => 'DÌ…CÌ…CÌ…CÌ…',
        '^5+9' => 'CÌ…MÌ…',
        '^6+1' => 'MÌ…',
        '^6+2' => 'MÌ…MÌ…',
        '^6+3' => 'MÌ…MÌ…MÌ…'
    ];

    /**
     * @var array Conversion set for Etruscan numerals.
     */
    private $Etruscan = [
        '.' => true,
        'UpperLimit' => 499,
        'LowerLimit' => 1,
        '0' => '',
        '1' => '',
        '2' => '',
        '3' => '',
        '4' => '',
        '5' => '',
        '6' => '',
        '7' => '',
        '8' => '',
        '9' => '',
        '^0+1' => 'ðŒ ',
        '^0+2' => 'ðŒ ðŒ ',
        '^0+3' => 'ðŒ ðŒ ðŒ ',
        '^0+4' => 'ðŒ ðŒ ðŒ ðŒ ',
        '^0+5' => 'ðŒ¡',
        '^0+6' => 'ðŒ¡ðŒ ',
        '^0+7' => 'ðŒ¡ðŒ ðŒ ',
        '^0+8' => 'ðŒ¡ðŒ ðŒ ðŒ ',
        '^0+9' => 'ðŒ¡ðŒ ðŒ ðŒ ðŒ ',
        '^1+1' => 'ðŒ¢',
        '^1+2' => 'ðŒ¢ðŒ¢',
        '^1+3' => 'ðŒ¢ðŒ¢ðŒ¢',
        '^1+4' => 'ðŒ¢ðŒ¢ðŒ¢ðŒ¢',
        '^1+5' => 'ðŒ£',
        '^1+6' => 'ðŒ£ðŒ¢',
        '^1+7' => 'ðŒ£ðŒ¢ðŒ¢',
        '^1+8' => 'ðŒ£ðŒ¢ðŒ¢ðŒ¢',
        '^1+9' => 'ðŒ£ðŒ¢ðŒ¢ðŒ¢ðŒ¢',
        '^2+1' => 'ðŒŸ',
        '^2+2' => 'ðŒŸðŒŸ',
        '^2+3' => 'ðŒŸðŒŸðŒŸ',
        '^2+4' => 'ðŒŸðŒŸðŒŸðŒŸ'
    ];

    /**
     * @var array Conversion set for Odia numerals.
     */
    private $Odia = [
        '0' => 'à­¦',
        '1' => 'à­§',
        '2' => 'à­¨',
        '3' => 'à­©',
        '4' => 'à­ª',
        '5' => 'à­«',
        '6' => 'à­¬',
        '7' => 'à­­',
        '8' => 'à­®',
        '9' => 'à­¯'
    ];

    /**
     * @var array Conversion set for Tibetan numerals.
     */
    private $Tibetan = [
        '0' => 'à¼ ',
        '1' => 'à¼¡',
        '2' => 'à¼¢',
        '3' => 'à¼£',
        '4' => 'à¼¤',
        '5' => 'à¼¥',
        '6' => 'à¼¦',
        '7' => 'à¼§',
        '8' => 'à¼¨',
        '9' => 'à¼©'
    ];

    /**
     * @var array Conversion set for Mongolian numerals.
     */
    private $Mongolian = [
        '0' => 'á ',
        '1' => 'á ‘',
        '2' => 'á ’',
        '3' => 'á “',
        '4' => 'á ”',
        '5' => 'á •',
        '6' => 'á –',
        '7' => 'á —',
        '8' => 'á ˜',
        '9' => 'á ™'
    ];

    /**
     * @var array Conversion set for Hebrew numerals (modern standard).
     */
    private $Hebrew = [
        '.' => true,
        'UpperLimit' => 1.0E+16,
        'LowerLimit' => 1,
        '+0' => '',
        '1' => '×',
        '2' => '×‘',
        '3' => '×’',
        '4' => '×“',
        '5' => '×”',
        '6' => '×•',
        '7' => '×–',
        '8' => '×—',
        '9' => '×˜',
        '^0+10' => '×™',
        '^0+11' => '×™×',
        '^0+12' => '×™×‘',
        '^0+13' => '×™×’',
        '^0+14' => '×™×“',
        '^0+15' => '×˜×´×•',
        '^0+16' => '×˜×´×–',
        '^0+17' => '×™×–',
        '^0+18' => '×™×—',
        '^0+19' => '×™×˜',
        '^1+1' => '',
        '^1+2' => '×›',
        '^1+3' => '×œ',
        '^1+4' => '×ž',
        '^1+5' => '× ',
        '^1+6' => '×¡',
        '^1+7' => '×¢',
        '^1+8' => '×¤',
        '^1+9' => '×¦',
        '^2+1' => '×§',
        '^2+2' => '×¨',
        '^2+3' => '×©',
        '^2+4' => '×ª',
        '^2+5' => '×š',
        '^2+6' => '×',
        '^2+7' => '×Ÿ',
        '^2+8' => '×£',
        '^2+9' => '×¥',
        '^3' => '×³',
        '^4' => '×³×™',
        '^5' => '×³×§',
        '^6' => '×³×³',
        '^7' => '×³×™×³',
        '^8' => '×³×§×³',
        '^9' => '×³×³×³',
        '^10' => '×³×™×³×³',
        '^11' => '×³×§×³×³',
        '^12' => '×³×³×³×³',
        '^13' => '×³×™×³×³×³',
        '^14' => '×³×§×³×³×³',
        '^15' => '×³×³×³×³×³'
    ];

    /**
     * @var array Conversion set for Armenian numerals (historic with overline).
     */
    private $Armenian = [
        '.' => true,
        'UpperLimit' => 99999999,
        'LowerLimit' => 1,
        '0' => '',
        '1' => '',
        '2' => '',
        '3' => '',
        '4' => '',
        '5' => '',
        '6' => '',
        '7' => '',
        '8' => '',
        '9' => '',
        '^0+1' => 'Ô±',
        '^0+2' => 'Ô²',
        '^0+3' => 'Ô³',
        '^0+4' => 'Ô´',
        '^0+5' => 'Ôµ',
        '^0+6' => 'Ô¶',
        '^0+7' => 'Ô·',
        '^0+8' => 'Ô¸',
        '^0+9' => 'Ô¹',
        '^1+1' => 'Ôº',
        '^1+2' => 'Ô»',
        '^1+3' => 'Ô¼',
        '^1+4' => 'Ô½',
        '^1+5' => 'Ô¾',
        '^1+6' => 'Ô¿',
        '^1+7' => 'Õ€',
        '^1+8' => 'Õ',
        '^1+9' => 'Õ‚',
        '^2+1' => 'Õƒ',
        '^2+2' => 'Õ„',
        '^2+3' => 'Õ…',
        '^2+4' => 'Õ†',
        '^2+5' => 'Õ‡',
        '^2+6' => 'Õˆ',
        '^2+7' => 'Õ‰',
        '^2+8' => 'ÕŠ',
        '^2+9' => 'Õ‹',
        '^3+1' => 'ÕŒ',
        '^3+2' => 'Õ',
        '^3+3' => 'ÕŽ',
        '^3+4' => 'Õ',
        '^3+5' => 'Õ',
        '^3+6' => 'Õ‘',
        '^3+7' => 'Õ’',
        '^3+8' => 'Õ“',
        '^3+9' => 'Õ”',
        '^4+1' => 'Ô±Ì…',
        '^4+2' => 'Ô²Ì…',
        '^4+3' => 'Ô³Ì…',
        '^4+4' => 'Ô´Ì…',
        '^4+5' => 'ÔµÌ…',
        '^4+6' => 'Ô¶Ì…',
        '^4+7' => 'Ô·Ì…',
        '^4+8' => 'Ô¸Ì…',
        '^4+9' => 'Ô¹Ì…',
        '^5+1' => 'ÔºÌ…',
        '^5+2' => 'Ô»Ì…',
        '^5+3' => 'Ô¼Ì…',
        '^5+4' => 'Ô½Ì…',
        '^5+5' => 'Ô¾Ì…',
        '^5+6' => 'Ô¿Ì…',
        '^5+7' => 'Õ€Ì…',
        '^5+8' => 'ÕÌ…',
        '^5+9' => 'Õ‚Ì…',
        '^6+1' => 'ÕƒÌ…',
        '^6+2' => 'Õ„Ì…',
        '^6+3' => 'Õ…Ì…',
        '^6+4' => 'Õ†Ì…',
        '^6+5' => 'Õ‡Ì…',
        '^6+6' => 'ÕˆÌ…',
        '^6+7' => 'Õ‰Ì…',
        '^6+8' => 'ÕŠÌ…',
        '^6+9' => 'Õ‹Ì…',
        '^7+1' => 'ÕŒÌ…',
        '^7+2' => 'ÕÌ…',
        '^7+3' => 'ÕŽÌ…',
        '^7+4' => 'ÕÌ…',
        '^7+5' => 'ÕÌ…',
        '^7+6' => 'Õ‘Ì…',
        '^7+7' => 'Õ’Ì…',
        '^7+8' => 'Õ“Ì…',
        '^7+9' => 'Õ”Ì…'
    ];

    /**
     * @var array Conversion set for standard simplified Chinese numerals.
     */
    private $ChineseSimplified = [
        'UpperLimit' => 1.0E+48,
        '+0' => '',
        '-0' => 'ã€‡',
        '=0' => 'ã€‡',
        '1' => 'ä¸€',
        '2' => 'äºŒ',
        '3' => 'ä¸‰',
        '4' => 'å››',
        '5' => 'äº”',
        '6' => 'å…­',
        '7' => 'ä¸ƒ',
        '8' => 'å…«',
        '9' => 'ä¹',
        '^1+1' => 'å',
        '^1' => 'å',
        '^2' => 'ç™¾',
        '^3' => 'åƒ',
        '^4' => 'ä¸‡',
        '^4+0' => 'ä¸‡',
        '^5' => 'å',
        '^6' => 'ç™¾',
        '^7' => 'åƒ',
        '^8' => 'äº¿',
        '^8+0' => 'äº¿',
        '^9' => 'å',
        '^10' => 'ç™¾',
        '^11' => 'åƒ',
        '^12' => 'å…†',
        '^12+0' => 'å…†',
        '^13' => 'å',
        '^14' => 'ç™¾',
        '^15' => 'åƒ',
        '^16' => 'äº¬',
        '^16+0' => 'äº¬',
        '^17' => 'å',
        '^18' => 'ç™¾',
        '^19' => 'åƒ',
        '^20' => 'åž“',
        '^20+0' => 'åž“',
        '^21' => 'å',
        '^22' => 'ç™¾',
        '^23' => 'åƒ',
        '^24' => 'ç§­',
        '^24+0' => 'ç§­',
        '^25' => 'å',
        '^26' => 'ç™¾',
        '^27' => 'åƒ',
        '^28' => 'ç©°',
        '^28+0' => 'ç©°',
        '^29' => 'å',
        '^30' => 'ç™¾',
        '^31' => 'åƒ',
        '^32' => 'æ²Ÿ',
        '^32+0' => 'æ²Ÿ',
        '^33' => 'å',
        '^34' => 'ç™¾',
        '^35' => 'åƒ',
        '^36' => 'æ¶§',
        '^36+0' => 'æ¶§',
        '^37' => 'å',
        '^38' => 'ç™¾',
        '^39' => 'åƒ',
        '^40' => 'æ­£',
        '^40+0' => 'æ­£',
        '^41' => 'å',
        '^42' => 'ç™¾',
        '^43' => 'åƒ',
        '^44' => 'è½½',
        '^44+0' => 'è½½',
        '^45' => 'å',
        '^46' => 'ç™¾',
        '^47' => 'åƒ'
    ];

    /**
     * @var array Conversion set for standard traditional Chinese numerals.
     */
    private $ChineseTraditional = [
        'UpperLimit' => 1.0E+48,
        '+0' => '',
        '-0' => 'é›¶',
        '=0' => 'é›¶',
        '1' => 'ä¸€',
        '2' => 'äºŒ',
        '3' => 'ä¸‰',
        '4' => 'å››',
        '5' => 'äº”',
        '6' => 'å…­',
        '7' => 'ä¸ƒ',
        '8' => 'å…«',
        '9' => 'ä¹',
        '^1+1' => 'å',
        '^1' => 'å',
        '^2' => 'ç™¾',
        '^3' => 'åƒ',
        '^4' => 'è¬',
        '^4+0' => 'è¬',
        '^5' => 'å',
        '^6' => 'ç™¾',
        '^7' => 'åƒ',
        '^8' => 'å„„',
        '^8+0' => 'å„„',
        '^9' => 'å',
        '^10' => 'ç™¾',
        '^11' => 'åƒ',
        '^12' => 'å…†',
        '^12+0' => 'å…†',
        '^13' => 'å',
        '^14' => 'ç™¾',
        '^15' => 'åƒ',
        '^16' => 'äº¬',
        '^16+0' => 'äº¬',
        '^17' => 'å',
        '^18' => 'ç™¾',
        '^19' => 'åƒ',
        '^20' => 'åž“',
        '^20+0' => 'åž“',
        '^21' => 'å',
        '^22' => 'ç™¾',
        '^23' => 'åƒ',
        '^24' => 'ç§­',
        '^24+0' => 'ç§­',
        '^25' => 'å',
        '^26' => 'ç™¾',
        '^27' => 'åƒ',
        '^28' => 'ç©°',
        '^28+0' => 'ç©°',
        '^29' => 'å',
        '^30' => 'ç™¾',
        '^31' => 'åƒ',
        '^32' => 'æº',
        '^32+0' => 'æº',
        '^33' => 'å',
        '^34' => 'ç™¾',
        '^35' => 'åƒ',
        '^36' => 'æ¾—',
        '^36+0' => 'æ¾—',
        '^37' => 'å',
        '^38' => 'ç™¾',
        '^39' => 'åƒ',
        '^40' => 'æ­£',
        '^40+0' => 'æ­£',
        '^41' => 'å',
        '^42' => 'ç™¾',
        '^43' => 'åƒ',
        '^44' => 'è¼‰',
        '^44+0' => 'è¼‰',
        '^45' => 'å',
        '^46' => 'ç™¾',
        '^47' => 'åƒ'
    ];

    /**
     * @var array Conversion set for financial simplified Chinese numerals.
     */
    private $ChineseSimplifiedFinancial = [
        'UpperLimit' => 1.0E+48,
        '+0' => '',
        '-0' => 'é›¶',
        '=0' => 'é›¶',
        '1' => 'å£¹',
        '2' => 'è´°',
        '3' => 'å',
        '4' => 'è‚†',
        '5' => 'ä¼',
        '6' => 'é™†',
        '7' => 'æŸ’',
        '8' => 'æŒ',
        '9' => 'çŽ–',
        '^1+1' => 'æ‹¾',
        '^1' => 'æ‹¾',
        '^2' => 'ä½°',
        '^3' => 'ä»Ÿ',
        '^4' => 'è¬',
        '^4+0' => 'è¬',
        '^5' => 'æ‹¾',
        '^6' => 'ä½°',
        '^7' => 'ä»Ÿ',
        '^8' => 'å„„',
        '^8+0' => 'å„„',
        '^9' => 'æ‹¾',
        '^10' => 'ä½°',
        '^11' => 'ä»Ÿ',
        '^12' => 'å…†',
        '^12+0' => 'å…†',
        '^13' => 'æ‹¾',
        '^14' => 'ä½°',
        '^15' => 'ä»Ÿ',
        '^16' => 'äº¬',
        '^16+0' => 'äº¬',
        '^17' => 'æ‹¾',
        '^18' => 'ä½°',
        '^19' => 'ä»Ÿ',
        '^20' => 'åž“',
        '^20+0' => 'åž“',
        '^21' => 'æ‹¾',
        '^22' => 'ä½°',
        '^23' => 'ä»Ÿ',
        '^24' => 'ç§­',
        '^24+0' => 'ç§­',
        '^25' => 'æ‹¾',
        '^26' => 'ä½°',
        '^27' => 'ä»Ÿ',
        '^28' => 'ç©°',
        '^28+0' => 'ç©°',
        '^29' => 'æ‹¾',
        '^30' => 'ä½°',
        '^31' => 'ä»Ÿ',
        '^32' => 'æ²Ÿ',
        '^32+0' => 'æ²Ÿ',
        '^33' => 'æ‹¾',
        '^34' => 'ä½°',
        '^35' => 'ä»Ÿ',
        '^36' => 'æ¶§',
        '^36+0' => 'æ¶§',
        '^37' => 'æ‹¾',
        '^38' => 'ä½°',
        '^39' => 'ä»Ÿ',
        '^40' => 'æ­£',
        '^40+0' => 'æ­£',
        '^41' => 'æ‹¾',
        '^42' => 'ä½°',
        '^43' => 'ä»Ÿ',
        '^44' => 'è½½',
        '^44+0' => 'è½½',
        '^45' => 'æ‹¾',
        '^46' => 'ä½°',
        '^47' => 'ä»Ÿ'
    ];

    /**
     * @var array Conversion set for financial traditional Chinese numerals.
     */
    private $ChineseTraditionalFinancial = [
        'UpperLimit' => 1.0E+48,
        '+0' => '',
        '-0' => 'é›¶',
        '=0' => 'é›¶',
        '1' => 'å£¹',
        '2' => 'è²³',
        '3' => 'å„',
        '4' => 'è‚†',
        '5' => 'ä¼',
        '6' => 'é™¸',
        '7' => 'æŸ’',
        '8' => 'æŒ',
        '9' => 'çŽ–',
        '^1+1' => 'æ‹¾',
        '^1' => 'æ‹¾',
        '^2' => 'ä½°',
        '^3' => 'ä»Ÿ',
        '^4' => 'è¬',
        '^4+0' => 'è¬',
        '^5' => 'æ‹¾',
        '^6' => 'ä½°',
        '^7' => 'ä»Ÿ',
        '^8' => 'å„„',
        '^8+0' => 'å„„',
        '^9' => 'æ‹¾',
        '^10' => 'ä½°',
        '^11' => 'ä»Ÿ',
        '^12' => 'å…†',
        '^12+0' => 'å…†',
        '^13' => 'æ‹¾',
        '^14' => 'ä½°',
        '^15' => 'ä»Ÿ',
        '^16' => 'äº¬',
        '^16+0' => 'äº¬',
        '^17' => 'æ‹¾',
        '^18' => 'ä½°',
        '^19' => 'ä»Ÿ',
        '^20' => 'åž“',
        '^20+0' => 'åž“',
        '^21' => 'æ‹¾',
        '^22' => 'ä½°',
        '^23' => 'ä»Ÿ',
        '^24' => 'ç§­',
        '^24+0' => 'ç§­',
        '^25' => 'æ‹¾',
        '^26' => 'ä½°',
        '^27' => 'ä»Ÿ',
        '^28' => 'ç©°',
        '^28+0' => 'ç©°',
        '^29' => 'æ‹¾',
        '^30' => 'ä½°',
        '^31' => 'ä»Ÿ',
        '^32' => 'æ²Ÿ',
        '^32+0' => 'æ²Ÿ',
        '^33' => 'æ‹¾',
        '^34' => 'ä½°',
        '^35' => 'ä»Ÿ',
        '^36' => 'æ¶§',
        '^36+0' => 'æ¶§',
        '^37' => 'æ‹¾',
        '^38' => 'ä½°',
        '^39' => 'ä»Ÿ',
        '^40' => 'æ­£',
        '^40+0' => 'æ­£',
        '^41' => 'æ‹¾',
        '^42' => 'ä½°',
        '^43' => 'ä»Ÿ',
        '^44' => 'è½½',
        '^44+0' => 'è½½',
        '^45' => 'æ‹¾',
        '^46' => 'ä½°',
        '^47' => 'ä»Ÿ'
    ];

    /**
     * @var array Conversion set for "dozenal" numerals (Dwiggins).
     */
    private $Dwiggins = ['a' => 'X', 'b' => 'E'];

    /**
     * @var array Conversion set for "dozenal" numerals (Pitman).
     */
    private $Pitman = ['a' => 'â†Š', 'b' => 'â†‹'];

    /**
     * @var array Conversion set for fullwidth numerals.
     */
    private $Fullwidth = [
        '0' => 'ï¼',
        '1' => 'ï¼‘',
        '2' => 'ï¼’',
        '3' => 'ï¼“',
        '4' => 'ï¼”',
        '5' => 'ï¼•',
        '6' => 'ï¼–',
        '7' => 'ï¼—',
        '8' => 'ï¼˜',
        '9' => 'ï¼™',
        'a' => 'ï½',
        'b' => 'ï½‚',
        'c' => 'ï½ƒ',
        'd' => 'ï½„',
        'e' => 'ï½…',
        'f' => 'ï½†',
        'g' => 'ï½‡',
        'h' => 'ï½ˆ',
        'i' => 'ï½‰',
        'j' => 'ï½Š',
        'k' => 'ï½‹',
        'l' => 'ï½Œ',
        'm' => 'ï½',
        'n' => 'ï½Ž',
        'o' => 'ï½',
        'p' => 'ï½',
        'q' => 'ï½‘',
        'r' => 'ï½’',
        's' => 'ï½“',
        't' => 'ï½”',
        'u' => 'ï½•',
        'v' => 'ï½–',
        'w' => 'ï½—',
        'x' => 'ï½˜',
        'y' => 'ï½™',
        'z' => 'ï½š'
    ];

    /**
     * @var array Conversion set for Ol Chiki numerals (used by Santali).
     */
    private $OlChiki = [
        '0' => 'á±',
        '1' => 'á±‘',
        '2' => 'á±’',
        '3' => 'á±“',
        '4' => 'á±”',
        '5' => 'á±•',
        '6' => 'á±–',
        '7' => 'á±—',
        '8' => 'á±˜',
        '9' => 'á±™'
    ];

    /**
     * @var array Conversion set for Kaktovik numerals.
     */
    private $Kaktovik = [
        '0' => 'ð‹€',
        '1' => 'ð‹',
        '2' => 'ð‹‚',
        '3' => 'ð‹ƒ',
        '4' => 'ð‹„',
        '5' => 'ð‹…',
        '6' => 'ð‹†',
        '7' => 'ð‹‡',
        '8' => 'ð‹ˆ',
        '9' => 'ð‹‰',
        'a' => 'ð‹Š',
        'b' => 'ð‹‹',
        'c' => 'ð‹Œ',
        'd' => 'ð‹',
        'e' => 'ð‹Ž',
        'f' => 'ð‹',
        'g' => 'ð‹',
        'h' => 'ð‹‘',
        'i' => 'ð‹’',
        'j' => 'ð‹“'
    ];

    /**
     * @var array Conversion set for Ge'ez/Ethiopic numerals.
     */
    private $Geez = [
        '.' => true,
        'LowerLimit' => 1,
        '0' => '',
        'o1' => 'á©',
        'o2' => 'áª',
        'o3' => 'á«',
        'o4' => 'á¬',
        'o5' => 'á­',
        'o6' => 'á®',
        'o7' => 'á¯',
        'o8' => 'á°',
        'o9' => 'á±',
        'e1' => 'á²',
        'e2' => 'á³',
        'e3' => 'á´',
        'e4' => 'áµ',
        'e5' => 'á¶',
        'e6' => 'á·',
        'e7' => 'á¸',
        'e8' => 'á¹',
        'e9' => 'áº',
        'Hundreds' => 'á»',
        'Hundreds+1' => '',
        'Myriads' => 'á¼',
        'Myriads+1' => ''
    ];

    /**
     * @var array Symbols quick lookup table.
     */
    private $Symbols = [
        10 => 'a',
        11 => 'b',
        12 => 'c',
        13 => 'd',
        14 => 'e',
        15 => 'f',
        16 => 'g',
        17 => 'h',
        18 => 'i',
        19 => 'j',
        20 => 'k',
        21 => 'l',
        22 => 'm',
        23 => 'n',
        24 => 'o',
        25 => 'p',
        26 => 'q',
        27 => 'r',
        28 => 's',
        29 => 't',
        30 => 'u',
        31 => 'v',
        32 => 'w',
        33 => 'x',
        34 => 'y',
        35 => 'z',
        'a' => '10',
        'b' => '11',
        'c' => '12',
        'd' => '13',
        'e' => '14',
        'f' => '15',
        'g' => '16',
        'h' => '17',
        'i' => '18',
        'j' => '19',
        'k' => '20',
        'l' => '21',
        'm' => '22',
        'n' => '23',
        'o' => '24',
        'p' => '25',
        'q' => '26',
        'r' => '27',
        's' => '28',
        't' => '29',
        'u' => '30',
        'v' => '31',
        'w' => '32',
        'x' => '33',
        'y' => '34',
        'z' => '35'
    ];

    /**
     * @var array Lookup table for unformatting a number.
     */
    private $UnformatTable = [
        '0' => ['Ù ', 'Û°', 'à§¦', 'à¥¦', 'à«¦', 'à©¦', 'à³¦', 'à±¦', 'á€', 'áŸ ', 'à¹', 'à»', 'ê§', 'à­¦', 'à¼ ', 'á ', 'ï¼', 'á±', 'ã€‡', 'é›¶', 'Z'],
        '1' => ['Ù¡', 'Û±', 'à§§', 'à¥§', 'à«§', 'à©§', 'à³§', 'à±§', 'á', 'áŸ¡', 'à¹‘', 'à»‘', 'ê§‘', 'à­§', 'à¼¡', 'á ‘', 'ï¼‘', 'á±‘', 'ä¸€', 'å£¹', 'á©', 'á²', 'à¯§'],
        '2' => ['Ù¢', 'Û²', 'à§¨', 'à¥¨', 'à«¨', 'à©¨', 'à³¨', 'à±¨', 'á‚', 'áŸ¢', 'à¹’', 'à»’', 'ê§’', 'à­¨', 'à¼¢', 'á ’', 'ï¼’', 'á±’', 'äºŒ', 'è´°', 'è²³', 'áª', 'á³', 'à¯¨'],
        '3' => ['Ù£', 'Û³', 'à§©', 'à¥©', 'à«©', 'à©©', 'à³©', 'à±©', 'áƒ', 'áŸ£', 'à¹“', 'à»“', 'ê§“', 'à­©', 'à¼£', 'á “', 'ï¼“', 'á±“', 'ä¸‰', 'å', 'å„', 'á«', 'á´', 'à¯©'],
        '4' => ['Ù¤', 'Û´', 'à§ª', 'à¥ª', 'à«ª', 'à©ª', 'à³ª', 'à±ª', 'á„', 'áŸ¤', 'à¹”', 'à»”', 'ê§”', 'à­ª', 'à¼¤', 'á ”', 'ï¼”', 'á±”', 'å››', 'è‚†', 'á¬', 'áµ', 'à¯ª'],
        '5' => ['Ù¥', 'Ûµ', 'à§«', 'à¥«', 'à««', 'à©«', 'à³«', 'à±«', 'á…', 'áŸ¥', 'à¹•', 'à»•', 'ê§•', 'à­«', 'à¼¥', 'á •', 'ï¼•', 'á±•', 'äº”', 'ä¼', 'á­', 'á¶', 'à¯«'],
        '6' => ['Ù¦', 'Û¶', 'à§¬', 'à¥¬', 'à«¬', 'à©¬', 'à³¬', 'à±¬', 'á†', 'áŸ¦', 'à¹–', 'à»–', 'ê§–', 'à­¬', 'à¼¦', 'á –', 'ï¼–', 'á±–', 'å…­', 'é™†', 'é™¸', 'á®', 'á·', 'à¯¬'],
        '7' => ['Ù§', 'Û·', 'à§­', 'à¥­', 'à«­', 'à©­', 'à³­', 'à±­', 'á‡', 'áŸ§', 'à¹—', 'à»—', 'ê§—', 'à­­', 'à¼§', 'á —', 'ï¼—', 'á±—', 'ä¸ƒ', 'æŸ’', 'á¯', 'á¸', 'à¯­'],
        '8' => ['Ù¨', 'Û¸', 'à§®', 'à¥®', 'à«®', 'à©®', 'à³®', 'à±®', 'áˆ', 'áŸ¨', 'à¹˜', 'à»˜', 'ê§˜', 'à­®', 'à¼¨', 'á ˜', 'ï¼˜', 'á±˜', 'å…«', 'æŒ', 'á°', 'á¹', 'à¯®'],
        '9' => ['Ù©', 'Û¹', 'à§¯', 'à¥¯', 'à«¯', 'à©¯', 'à³¯', 'à±¯', 'á‰', 'áŸ©', 'à¹™', 'à»™', 'ê§™', 'à­¯', 'à¼©', 'á ™', 'ï¼™', 'á±™', 'ä¹', 'çŽ–', 'á±', 'áº', 'à¯¯']
    ];

    /**
     * @var array Precheck lookup table for unformatting a number.
     */
    private $UnformatTablePre = [
        'I' => ['â… ', 'â…°', 'ðŒ '],
        'II' => ['â…¡', 'â…±'],
        'III' => ['â…¢', 'â…²'],
        'IV' => ['â…£', 'â…³'],
        'V' => ['â…¤', 'â…´', 'ðŒ¡'],
        'VI' => ['â…¥', 'â…µ', 'â†…'],
        'VII' => ['â…¦', 'â…¶'],
        'VIII' => ['â…§', 'â…·'],
        'IX' => ['â…¨', 'â…¸'],
        'X' => ['â…©', 'â…¹', 'ðŒ¢'],
        'XI' => ['â…ª', 'â…º'],
        'XII' => ['â…«', 'â…»'],
        'L' => ['â…¬', 'â…¼', 'â††', 'ðŒ£'],
        'C' => ['â…­', 'â…½', 'â†ƒ', 'â†„', 'ðŒŸ'],
        'D' => ['â…®', 'â…¾'],
        'M' => ['â…¯', 'â…¿', 'â†€'],
        'v' => ['â†'],
        'x' => ['â†‚'],
        'l' => ['â†‡'],
        'c' => ['â†ˆ']
    ];

    /**
     * @var array Patterns for unformatting a number.
     */
    private $UnformatPattern = [
        '~^(á»|á¼)~' => '1\1',
        '~(á»|á¼)(?!á²|á³|á´|áµ|á¶|á·|á¸|á¹|áº|\d)~' => '\1Z',
        '~(á»[\dZ]|á¼[\dZ])(?!á©|áª|á«|á¬|á­|á®|á¯|á°|á±|\d)~' => '\1Z',
        '~(á²|á³|á´|áµ|á¶|á·|á¸|á¹|áº)(?!á©|áª|á«|á¬|á­|á®|á¯|á°|á±)~' => '\1Z',
        '~á»$~' => '00',
        '~á¼$~' => '0000'
    ];

    /**
     * @var array Lookup table for unformatting a base-20 number.
     */
    private $UnformatTableKakMay = [
        '0' => ['ð‹€', 'ð‹ '],
        '1' => ['ð‹', 'ð‹¡'],
        '2' => ['ð‹‚', 'ð‹¢'],
        '3' => ['ð‹ƒ', 'ð‹£'],
        '4' => ['ð‹„', 'ð‹¤'],
        '5' => ['ð‹…', 'ð‹¥'],
        '6' => ['ð‹†', 'ð‹¦'],
        '7' => ['ð‹‡', 'ð‹§'],
        '8' => ['ð‹ˆ', 'ð‹¨'],
        '9' => ['ð‹‰', 'ð‹©'],
        'a' => ['ð‹Š', 'ð‹ª'],
        'b' => ['ð‹‹', 'ð‹«'],
        'c' => ['ð‹Œ', 'ð‹¬'],
        'd' => ['ð‹', 'ð‹­'],
        'e' => ['ð‹Ž', 'ð‹®'],
        'f' => ['ð‹', 'ð‹¯'],
        'g' => ['ð‹', 'ð‹°'],
        'h' => ['ð‹‘', 'ð‹±'],
        'i' => ['ð‹’', 'ð‹²'],
        'j' => ['ð‹“', 'ð‹³']
    ];

    /**
     * @var array Lookup table for unformatting a base-12 number.
     */
    private $UnformatTableDuoDec = ['a' => 'â†Š', 'b' => 'â†‹'];

    /**
     * @var array Lookup table for unformatting Roman numerals and similar systems.
     */
    private $UnformatRoman = [
        'm' => 1000000,
        'd' => 500000,
        'c' => 100000,
        'l' => 50000,
        'x' => 10000,
        'v' => 5000,
        'M' => 1000,
        'D' => 500,
        'C' => 100,
        'L' => 50,
        'X' => 10,
        'V' => 5,
        'I' => 1
    ];

    /**
     * @var array Lookup table for unformatting Chinese numerals and similar systems.
     */
    private $UnformatChinese = [
        'ã€¡' => 1,
        'ä¸€' => 1,
        'å£¹' => 1,
        'ã€¢' => 2,
        'äºŒ' => 2,
        'å…©' => 2,
        'è²³' => 2,
        'è´°' => 2,
        'ã€£' => 3,
        'ä¸‰' => 3,
        'å' => 3,
        'å„' => 3,
        'ã€¤' => 4,
        'å››' => 4,
        'è‚†' => 4,
        'ã€¥' => 5,
        'äº”' => 5,
        'ä¼' => 5,
        'ã€¦' => 6,
        'å…­' => 6,
        'é™†' => 6,
        'é™¸' => 6,
        'ã€§' => 7,
        'ä¸ƒ' => 7,
        'æŸ’' => 7,
        'ã€¨' => 8,
        'å…«' => 8,
        'æŒ' => 8,
        'ã€©' => 9,
        'ä¹' => 9,
        'çŽ–' => 9,
        'ã€¸' => 10,
        'å' => 10,
        'æ‹¾' => 10,
        'ã€¹' => 20,
        'ã€º' => 30,
        'ä½°' => 100,
        'ç™¾' => 100,
        'ä»Ÿ' => 1000,
        'åƒ' => 1000,
        'ä¸‡' => 10000,
        'è¬' => 10000,
        'äº¿' => 100000000,
        'å„„' => 100000000,
        'å…†' => 1000000000000,
        'äº¬' => 10000000000000000,
        'åž“' => 100000000000000000000,
        'ç§­' => 1.0E+24,
        'ç©°' => 1.0E+28,
        'æ²Ÿ' => 1.0E+32,
        'æ¶§' => 1.0E+36,
        'æ­£' => 1.0E+40,
        'è¼‰' => 1.0E+44
    ];

    /**
     * @var array Lookup table for unformatting Japanese numerals and similar systems.
     */
    private $UnformatJapanese = [
        'ä¸€' => 1,
        'äºŒ' => 2,
        'ä¸‰' => 3,
        'å››' => 4,
        'äº”' => 5,
        'å…­' => 6,
        'ä¸ƒ' => 7,
        'å…«' => 8,
        'ä¹' => 9,
        'å' => 10,
        'ç™¾' => 100,
        'åƒ' => 1000,
        'ä¸‡' => 10000,
        'å„„' => 100000000,
        'å…†' => 1000000000000,
        'äº¬' => 10000000000000000,
        'åž“' => 100000000000000000000,
        'åˆ†' => 0.01,
        'åŽ˜' => 0.001,
        'æ¯›' => 0.0001,
        'ç³¸' => 0.00001,
        'å¿½' => 0.000001,
        'å¾®' => 0.0000001,
        'ç¹Š' => 0.00000001,
        'æ²™' => 0.000000001,
        'å¡µ' => 0.0000000001,
        'åŸƒ' => 0.00000000001
    ];

    /**
     * @var array Lookup table for unformatting Tamil numerals.
     */
    private $UnformatTamil = [
        'à¯§' => 1,
        'à¯¨' => 2,
        'à¯©' => 3,
        'à¯ª' => 4,
        'à¯«' => 5,
        'à¯¬' => 6,
        'à¯­' => 7,
        'à¯®' => 8,
        'à¯¯' => 9,
        'à¯°' => 10,
        'à¯±' => 100,
        'à¯²' => 1000
    ];

    /**
     * @var array Lookup table for unformatting Armenian numerals and similar systems.
     */
    private $UnformatArmenian = [
        'Ô±' => 1,
        'Ô²' => 2,
        'Ô³' => 3,
        'Ô´' => 4,
        'Ôµ' => 5,
        'Ô¶' => 6,
        'Ô·' => 7,
        'Ô¸' => 8,
        'Ô¹' => 9,
        'Ôº' => 10,
        'Ô»' => 20,
        'Ô¼' => 30,
        'Ô½' => 40,
        'Ô¾' => 50,
        'Ô¿' => 60,
        'Õ€' => 70,
        'Õ' => 80,
        'Õ‚' => 90,
        'Õƒ' => 100,
        'Õ„' => 200,
        'Õ…' => 300,
        'Õ†' => 400,
        'Õ‡' => 500,
        'Õˆ' => 600,
        'Õ‰' => 700,
        'ÕŠ' => 800,
        'Õ‹' => 900,
        'ÕŒ' => 1000,
        'Õ' => 2000,
        'ÕŽ' => 3000,
        'Õ' => 4000,
        'Õ' => 5000,
        'Õ‘' => 6000,
        'Õ’' => 7000,
        'Õ“' => 8000,
        'Õ”' => 9000
    ];

    /**
     * Constructor.
     *
     * @param string $Format Can use this to quickly set commonly used
     *      definitions during object instantiation.
     * @return void
     */
    public function __construct(string $Format = '')
    {
        if ($Format === '' || $Format === 'Latin-1') {
            return;
        }
        if ($Format === 'NoSep-1') {
            $this->GroupSeparator = '';
            return;
        }
        if ($Format === 'NoSep-2') {
            $this->GroupSeparator = '';
            $this->DecimalSeparator = ',';
            return;
        }
        if ($Format === 'Latin-2') {
            $this->GroupSeparator = 'â€¯';
            return;
        }
        if ($Format === 'Latin-3') {
            $this->GroupSeparator = '.';
            $this->DecimalSeparator = ',';
            return;
        }
        if ($Format === 'Latin-4') {
            $this->GroupSeparator = 'â€¯';
            $this->DecimalSeparator = ',';
            return;
        }
        if ($Format === 'Latin-5') {
            $this->DecimalSeparator = 'Â·';
            return;
        }
        if ($Format === 'Arabic-2') {
            $this->ConversionSet = 'Eastern';
            $this->GroupSeparator = 'Ù¬';
            $this->DecimalSeparator = 'Ù«';
            return;
        }
        if ($Format === 'Arabic-3' || $Format === 'Persian') {
            $this->ConversionSet = 'Persian';
            $this->GroupSeparator = 'Ù¬';
            $this->DecimalSeparator = 'Ù«';
            return;
        }
        if ($Format === 'Arabic-4' || $Format === 'Urdu') {
            $this->ConversionSet = 'Persian';
            $this->GroupSeparator = 'Ù¬';
            $this->DecimalSeparator = 'Ù«';
            $this->GroupSize = 2;
            $this->GroupOffset = -1;
            return;
        }
        if ($Format === 'Chinese-Simplified') {
            $this->ConversionSet = 'ChineseSimplified';
            $this->GroupSeparator = '';
            $this->DecimalSeparator = 'ç‚¹';
            return;
        }
        if ($Format === 'Chinese-Simplified-Financial') {
            $this->ConversionSet = 'ChineseSimplifiedFinancial';
            $this->GroupSeparator = '';
            $this->DecimalSeparator = 'ç‚¹';
            return;
        }
        if ($Format === 'Chinese-Traditional') {
            $this->ConversionSet = 'ChineseTraditional';
            $this->GroupSeparator = '';
            $this->DecimalSeparator = 'é»ž';
            return;
        }
        if ($Format === 'Chinese-Traditional-Financial') {
            $this->ConversionSet = 'ChineseTraditionalFinancial';
            $this->GroupSeparator = '';
            $this->DecimalSeparator = 'é»ž';
            return;
        }
        if ($Format === 'India-2' || $Format === 'Devanagari') {
            $this->ConversionSet = 'Devanagari';
            $this->GroupSize = 2;
            $this->GroupOffset = -1;
            return;
        }
        if ($Format === 'India-3' || $Format === 'Gujarati') {
            $this->ConversionSet = 'Gujarati';
            $this->GroupSize = 2;
            $this->GroupOffset = -1;
            return;
        }
        if ($Format === 'India-4' || $Format === 'Gurmukhi') {
            $this->ConversionSet = 'Gurmukhi';
            $this->GroupSize = 2;
            $this->GroupOffset = -1;
            return;
        }
        if ($Format === 'India-5' || $Format === 'Kannada') {
            $this->ConversionSet = 'Kannada';
            $this->GroupSize = 2;
            $this->GroupOffset = -1;
            return;
        }
        if ($Format === 'India-6' || $Format === 'Telugu') {
            $this->ConversionSet = 'Telugu';
            $this->GroupSize = 2;
            $this->GroupOffset = -1;
            return;
        }
        if ($Format === 'Thai-2') {
            $this->ConversionSet = 'Thai';
            $this->GroupSeparator = '';
            return;
        }
        $Format = explode('-', $Format);
        if ($Format[0] === 'Arabic') {
            $this->ConversionSet = 'Eastern';
            $this->GroupSeparator = '';
            $this->DecimalSeparator = 'Ù«';
            return;
        }
        if (
            $Format[0] === 'Armenian' ||
            $Format[0] === 'Etruscan' ||
            $Format[0] === 'Geez' ||
            $Format[0] === 'Hebrew' ||
            $Format[0] === 'Roman' ||
            $Format[0] === 'Tamil'
        ) {
            $this->ConversionSet = $Format[0];
            $this->GroupSeparator = '';
            $this->DecimalSeparator = '';
            return;
        }
        if ($Format[0] === 'Base') {
            $this->GroupSeparator = '';
            $this->Base = (int)($Format[1] ?? 0);
            return;
        }
        if ($Format[0] === 'Bangla' || $Format[0] === 'Bengali' || $Format[0] === 'Nagari') {
            $this->ConversionSet = 'Nagari';
            $this->GroupSize = 2;
            $this->GroupOffset = -1;
            return;
        }
        if ($Format[0] === 'Burmese') {
            $this->ConversionSet = 'Burmese';
            $this->GroupSeparator = '';
            return;
        }
        if ($Format[0] === 'China') {
            $this->GroupSize = 4;
            return;
        }
        if (
            $Format[0] === 'Fullwidth' ||
            $Format[0] === 'Javanese' ||
            $Format[0] === 'Lao' ||
            $Format[0] === 'Mongolian' ||
            $Format[0] === 'Odia' ||
            $Format[0] === 'Tibetan'
        ) {
            $this->ConversionSet = $Format[0];
            $this->GroupSeparator = '';
            return;
        }
        if ($Format[0] === 'India') {
            $this->GroupSize = 2;
            $this->GroupOffset = -1;
            return;
        }
        if ($Format[0] === 'Japanese') {
            $this->ConversionSet = 'Japanese';
            $this->GroupSeparator = '';
            $this->DecimalSeparator = 'ãƒ»';
            return;
        }
        if ($Format[0] === 'Kaktovik' || $Format[0] === 'Mayan') {
            $this->ConversionSet = $Format[0];
            $this->GroupSeparator = '';
            $this->Base = 20;
            return;
        }
        if ($Format[0] === 'Khmer') {
            $this->ConversionSet = 'Khmer';
            $this->GroupSeparator = '.';
            $this->DecimalSeparator = ',';
            return;
        }
        if ($Format[0] === 'SDN' && isset($Format[1]) && property_exists($this, $Format[1])) {
            $this->ConversionSet = $Format[1];
            $this->DecimalSeparator = ';';
            $this->Base = 12;
            return;
        }
        if ($Format[0] === 'Thai') {
            $this->ConversionSet = 'Thai';
            return;
        }
    }

    /**
     * Formats the supplied number according to definitions.
     *
     * @param mixed $Number The number to format (int, float, string, etc).
     * @param int $Decimals The number of decimal places (optional).
     * @return string The formatted number, or an empty string on failure.
     */
    public function format($Number, int $Decimals = 0): string
    {
        /** Guard. */
        if ($this->Base < 2 || $this->Base > 36 || $this->limits($Number)) {
            return '';
        }

        $CSet = $this->{$this->ConversionSet};
        $DecPos = strpos($Number, '.');
        if ($DecPos !== false) {
            if ($Decimals > 0 && $this->DecimalSeparator && empty($CSet['.'])) {
                $Fraction = substr($Number, $DecPos + 1) ?: '';
                $Len = strlen($Fraction);
                if ($Len > 0) {
                    $Fraction = $this->convertFraction($Fraction, 10, $this->Base, $Decimals);
                    $Fraction = substr($Fraction, 0, $Decimals);
                    $Len = strlen($Fraction);
                }
                if ($Len < $Decimals) {
                    $Fraction .= str_repeat('0', $Decimals - $Len);
                }
            }
            $Number = (string)(int)substr($Number, 0, $DecPos);
        } else {
            $Number = (string)(int)$Number;
        }
        if ($this->Base !== 10) {
            $Number = base_convert($Number, 10, $this->Base);
        }
        if (isset($CSet['=' . $Number])) {
            $Formatted = $CSet['=' . $Number];
            $WholeLen = -1;
        } else {
            $WholeLen = strlen($Number);
        }
        for ($OddEven = 'o', $Unit = 0, $Formatted = '', $ThouPos = $this->GroupOffset, $Pos = $WholeLen - 1; $Pos > -1; $Pos--, $Unit++, $OddEven = $OddEven === 'o' ? 'e' : 'o') {
            if ($ThouPos >= $this->GroupSize) {
                $ThouPos = 1;
                $Formatted = $this->GroupSeparator . $Formatted;
            } else {
                $ThouPos++;
            }
            if ($Unit === 0) {
                $Myriads = false;
                $Hundreds = false;
            } else {
                $Myriads = ($Unit % 4) === 0;
                $Hundreds = $Myriads === false && ($Unit % 2) === 0;
            }
            $Key = substr($Number, $Pos, 1);
            $Double = $Pos > 0 ? substr($Number, $Pos - 1, 1) . $Key : '';
            $Power = '';
            $Digit = '';
            if (isset($CSet['^' . $Unit . '+' . $Double])) {
                $Digit = $CSet['^' . $Unit . '+' . $Double];
            } elseif (isset($CSet['^' . $Unit . '+' . $Key])) {
                $Digit = $CSet['^' . $Unit . '+' . $Key];
            } elseif (isset($CSet['+' . $Key])) {
                $Digit = $CSet['+' . $Key];
            } else {
                $Digit = $CSet[$OddEven . $Key] ?? $CSet[$Key] ?? $Key;
                if ($Myriads && isset($CSet['Myriads'])) {
                    $Power = $CSet['Myriads'];
                    if (isset($CSet['Myriads+' . $Key])) {
                        $Digit = $CSet['Myriads+' . $Key];
                    }
                } elseif ($Hundreds && isset($CSet['Hundreds'])) {
                    $Power = $CSet['Hundreds'];
                    if (isset($CSet['Hundreds+' . $Key])) {
                        $Digit = $CSet['Hundreds+' . $Key];
                    }
                } elseif (isset($CSet['^' . $Unit])) {
                    $Power = $CSet['^' . $Unit];
                }
            }
            $Formatted = $Digit . $Power . $Formatted;
        }
        if (isset($Fraction) && $Decimals && $this->DecimalSeparator && empty($CSet['.'])) {
            $Formatted .= $this->DecimalSeparator;
            for ($Len = strlen($Fraction), $Pos = 0; $Pos < $Len; $Pos++) {
                $Key = substr($Fraction, $Pos, 1);
                $Power = '';
                $Digit = '';
                if (isset($CSet['^-' . $Pos . '+' . $Key])) {
                    $Digit = $CSet['^-' . $Pos . '+' . $Key];
                } elseif (isset($CSet['-+' . $Key])) {
                    $Digit = $CSet['-+' . $Key];
                } else {
                    if (isset($CSet['-' . $Key])) {
                        $Digit = $CSet['-' . $Key];
                    } else {
                        $Digit = $CSet[$Key] ?? $Key;
                    }
                    if (isset($CSet['^-' . $Pos])) {
                        $Power = $CSet['^-' . $Pos];
                    }
                }
                $Formatted .= $Digit . $Power;
            }
        }
        if (($DecLen = strlen($this->DecimalSeparator)) && substr($Formatted, 0, $DecLen) === $this->DecimalSeparator) {
            $Formatted = substr($Formatted, $DecLen);
        }
        return $Formatted;
    }

    /**
     * Gets the specified conversion set and returns it as a JSON string.
     *
     * @param string $Set The specified conversion set.
     * @return string A JSON string.
     */
    public function getSetJSON(string $Set = ''): string
    {
        return isset($this->{$Set}) ? json_encode($this->{$Set}) : '[]';
    }

    /**
     * Unformats the formatted number according to predefined patterns and lookup
     * tables. Warning: Doesn't work for ALL formats (..yet).
     *
     * @param string $Number The number to unformat.
     * @param string $DecSep The decimal separator to look for. When specified,
     *      will attempt to unformat fractions. When not specified, won't.
     * @param int $MinBase The minimum base to interpret from the source number.
     * @return string The unformatted number (returned as a string rather than as
     *      an integer or a float in order to retain decimal precision).
     */
    public function unformat(string $Number, string $DecSep = '', int $MinBase = 10): string
    {
        /** Return early if supplied an empty number. */
        if ($Number === '') {
            return '0';
        }

        /** Guard for base_convert's minimum and maximum range. */
        if ($MinBase < 2) {
            $MinBase = 2;
        } elseif ($MinBase > 35) {
            $MinBase = 35;
        }

        /** Auto-populate SDN separator when format matches. */
        if ($MinBase <= 12 && preg_match('~^((?:[\dEX]|â†Š|â†‹)+,)+(?:[\dEX]|â†Š|â†‹)+(;(?:[\dEX]|â†Š|â†‹)+)+$~', $Number)) {
            $MinBase = 12;
            $DecSep = ';';
        }

        /** Dwiggins check. */
        if ($MinBase === 12) {
            $Number = str_replace(['X', 'E'], ['a', 'b'], $Number);
        }

        /** Other pre-checks. */
        if (preg_match('~\D~', $Number)) {
            foreach ($this->UnformatTablePre as $Replacement => $Lookup) {
                $Number = str_replace($Lookup, $Replacement, $Number);
            }
        }

        /** Roman check. */
        if ($MinBase === 10 && preg_match('~[MDCLXVImdclxvi]|Ì…~', $Number) && !preg_match('~[^MDCLXVImdclxviÌ…]|\xCC(?:[^\x85]|$)|(?:^|[^\xCC])\x85~', $Number)) {
            $Number = str_replace(['MÌ…', 'DÌ…', 'CÌ…', 'LÌ…', 'XÌ…', 'VÌ…', 'IÌ…'], ['m', 'd', 'c', 'l', 'x', 'v', 'M'], $Number);
            $Len = strlen($Number);
            $Out = 0;
            for ($Iter = 0; $Iter < $Len; $Iter++) {
                $Unit = $this->UnformatRoman[substr($Number, $Iter, 1)] ?? 0;
                $Next = $this->UnformatRoman[substr($Number, $Iter + 1, 1)] ?? 0;
                $Out = $Next !== 0 && $Unit < $Next ? $Out - $Unit : $Out + $Unit;
            }
            return (string)$Out;
        }

        /** Chinese check. */
        if (
            preg_match('~^(?:...)*(?:ã€¡|ä¸€|å£¹|ã€¢|äºŒ|å…©|è²³|è´°|ã€£|ä¸‰|å|å„|ã€¤|å››|è‚†|ã€¥|äº”|ä¼|ã€¦|å…­|é™†|é™¸|ã€§|ä¸ƒ|æŸ’|ã€¨|å…«|æŒ|ã€©|ä¹|çŽ–|ã€¸|å|æ‹¾|ã€¹|ã€º|ä½°|ç™¾|ä»Ÿ|åƒ|ä¸‡|è¬|äº¿|å„„|å…†|äº¬|åž“|ç§­|ç©°|æ²Ÿ|æ¶§|æ­£|è¼‰)~', $Number) &&
            !preg_match('~^(?:...)*(?:åˆ†|åŽ˜|æ¯›|ç³¸|å¿½|å¾®|ç¹Š|æ²™|å¡µ|åŸƒ)~', $Number)
        ) {
            $Len = strlen($Number);
            if ($Len % 3 === 0) {
                $Out = 0;
                $Stack = 0;
                $Queue = 1;
                $DecPassed = false;
                for ($Iter = 0; $Iter < $Len; $Iter += 3) {
                    $Unit = substr($Number, $Iter, 3);
                    if ($Unit === 'ç‚¹' || $Unit === 'é»ž') {
                        $Out += $Stack;
                        if ($Out >= PHP_INT_MAX) {
                            break;
                        }
                        $DecPassed = true;
                        $Out .= '.';
                        continue;
                    }
                    $Unit = $this->UnformatChinese[$Unit] ?? 0;
                    if ($DecPassed) {
                        $Out .= $Unit;
                        continue;
                    }
                    $Queue *= $Unit;
                    if ($Queue >= 10000) {
                        $Stack *= $Unit;
                        $Out += $Queue + $Stack;
                        $Queue = 1;
                        $Stack = 0;
                        continue;
                    }
                    $Next = $this->UnformatChinese[substr($Number, $Iter + 3, 3)] ?? 0;
                    if ($Next < 10) {
                        $Stack += $Queue;
                        $Queue = 1;
                    }
                }
                if (!$DecPassed) {
                    $Out += $Stack;
                }
                return $DecPassed ? preg_replace('~\.*0*$~', '', $Out) : (string)$Out;
            }
        }

        /** Japanese check. */
        if (
            preg_match('~^(?:...)*(?:ä¸€|äºŒ|ä¸‰|å››|äº”|å…­|ä¸ƒ|å…«|ä¹|å|ç™¾|åƒ|ä¸‡|å„„|å…†|äº¬|åž“|åˆ†|åŽ˜|æ¯›|ç³¸|å¿½|å¾®|ç¹Š|æ²™|å¡µ|åŸƒ)~', $Number) &&
            !preg_match('~^(?:...)*(?:ã€¡|å£¹|ã€¢|å…©|è²³|è´°|ã€£|å|å„|ã€¤|è‚†|ã€¥|ä¼|ã€¦|é™†|é™¸|ã€§|æŸ’|ã€¨|æŒ|ã€©|çŽ–|ä½°|ã€¸|æ‹¾|ã€¹|ã€º|ä»Ÿ|è¬|äº¿|ç§­|ç©°|æ²Ÿ|æ¶§|æ­£|è¼‰)~', $Number)
        ) {
            $Len = strlen($Number);
            if ($Len % 3 === 0) {
                $Out = 0;
                $Queue = 1;
                $Prev = null;
                for ($Iter = 0; $Iter < $Len; $Iter += 3) {
                    $Unit = $this->UnformatJapanese[substr($Number, $Iter, 3)] ?? 0;
                    $Queue *= $Unit;
                    if ($Prev === 0) {
                        $Queue *= 0.1;
                    }
                    $Next = $this->UnformatJapanese[substr($Number, $Iter + 3, 3)] ?? 0;
                    if (($Next >= 1 && $Next < 10) || $Next === 0 || $Queue < 1) {
                        $Out += $Queue;
                        $Queue = 1;
                    }
                    $Prev = $Unit;
                }
                return (string)$Out;
            }
        }

        /** Tamil check. */
        if (preg_match('~^(?:...)*(?:à¯§|à¯¨|à¯©|à¯ª|à¯«|à¯¬|à¯­|à¯®|à¯¯|à¯°|à¯±|à¯²)~', $Number)) {
            $Len = strlen($Number);
            if ($Len % 3 === 0) {
                $Out = 0;
                $Queue = 1;
                for ($Iter = 0; $Iter < $Len; $Iter += 3) {
                    $Unit = $this->UnformatTamil[substr($Number, $Iter, 3)] ?? 0;
                    $Queue *= $Unit;
                    $Next = $this->UnformatTamil[substr($Number, $Iter + 3, 3)] ?? 0;
                    if ($Next < 10) {
                        $Out += $Queue;
                        $Queue = 1;
                        if ($Next === 0) {
                            break;
                        }
                    }
                }
                return (string)$Out;
            }
        }

        /** Armenian check. */
        if (preg_match('~^(?:..)*(?:Ô±|Ô²|Ô³|Ô´|Ôµ|Ô¶|Ô·|Ô¸|Ô¹|Ôº|Ô»|Ô¼|Ô½|Ô¾|Ô¿|Õ€|Õ|Õ‚|Õƒ|Õ„|Õ…|Õ†|Õ‡|Õˆ|Õ‰|ÕŠ|Õ‹|ÕŒ|Õ|ÕŽ|Õ|Õ|Õ‘|Õ’|Õ“|Õ”)~', $Number)) {
            $Len = strlen($Number);
            if ($Len % 2 === 0) {
                $Out = 0;
                for ($Iter = 0; $Iter < $Len; $Iter += 2) {
                    $Unit = $this->UnformatArmenian[substr($Number, $Iter, 2)] ?? 0;
                    if ($Unit === 0) {
                        continue;
                    }
                    $Next = substr($Number, $Iter + 2, 2);
                    if ($Next === 'Ì…') {
                        $Unit *= 10000;
                    }
                    $Out += $Unit;
                }
                return (string)$Out;
            }
        }

        /** Fractions. */
        if ($DecSep !== '') {
            if (($DSPos = strrpos($Number, $DecSep)) !== false) {
                $Fraction = substr($Number, $DSPos + strlen($DecSep));
                $Number = substr($Number, 0, $DSPos);
            } else {
                $Fraction = '';
            }
            if (preg_match('~\D~', $Fraction)) {
                foreach ($this->UnformatTable as $Replacement => $Lookup) {
                    $Fraction = str_replace($Lookup, $Replacement, $Fraction);
                }
                $KakMay = $Fraction;
                foreach ($this->UnformatTableKakMay as $Replacement => $Lookup) {
                    $KakMay = str_replace($Lookup, $Replacement, $KakMay);
                }
                if ($KakMay !== $Fraction) {
                    if ($MinBase < 20) {
                        $MinBase = 20;
                    }
                    $Fraction = $KakMay;
                }
                $DuoDec = $Fraction;
                foreach ($this->UnformatTableDuoDec as $Replacement => $Lookup) {
                    $DuoDec = str_replace($Lookup, $Replacement, $DuoDec);
                }
                if ($DuoDec !== $Fraction) {
                    if ($MinBase < 12) {
                        $MinBase = 12;
                    }
                    $Fraction = $DuoDec;
                }
                for ($Base = $MinBase; $Base < 36; $Base++) {
                    if (strpos($Fraction, $this->Symbols[$Base]) !== false) {
                        $MinBase = $Base;
                    }
                }
            }
            $Fraction = preg_replace('~0+$~', '', $Fraction);
        } else {
            $Fraction = '';
        }

        /** Whole numbers. */
        if (preg_match('~\D~', $Number)) {
            foreach ($this->UnformatPattern as $Pattern => $Replacement) {
                $Number = preg_replace($Pattern, $Replacement, $Number);
            }
            foreach ($this->UnformatTable as $Replacement => $Lookup) {
                $Number = str_replace($Lookup, $Replacement, $Number);
            }
            $KakMay = $Number;
            foreach ($this->UnformatTableKakMay as $Replacement => $Lookup) {
                $KakMay = str_replace($Lookup, $Replacement, $KakMay);
            }
            if ($KakMay !== $Number) {
                if ($MinBase < 20) {
                    $MinBase = 20;
                }
                $Number = $KakMay;
            }
            $DuoDec = $Number;
            foreach ($this->UnformatTableDuoDec as $Replacement => $Lookup) {
                $DuoDec = str_replace($Lookup, $Replacement, $DuoDec);
            }
            if ($DuoDec !== $Number) {
                if ($MinBase < 12) {
                    $MinBase = 12;
                }
                $Number = $DuoDec;
            }
            for ($Base = $MinBase; $Base < 36; $Base++) {
                if (strpos($Number, $this->Symbols[$Base]) !== false) {
                    $MinBase = $Base;
                }
            }
            $Number = preg_replace('~^0+~', '', $Number);
        }

        /** Strip unwanted bytes and convert base if necessary. */
        if ($MinBase === 10) {
            if ($Fraction !== '') {
                $Fraction = preg_replace('~\D~', '', $Fraction);
            }
            if ($Number !== '') {
                $Number = preg_replace('~\D~', '', $Number);
            }
        } elseif ($MinBase > 10) {
            $Range = $MinBase === 11 ? 'a' : 'a-' . $this->Symbols[$MinBase];
            if ($Fraction !== '') {
                $Fraction = $this->convertFraction(preg_replace('~[^\d' . $Range . ']~', '', $Fraction), $MinBase, 10, 50);
            }
            if ($Number !== '') {
                $Number = base_convert(preg_replace('~[^\d' . $Range . ']~', '', $Number), $MinBase, 10);
            }
        } elseif ($MinBase < 10) {
            if ($Fraction !== '') {
                $Fraction = $this->convertFraction($Fraction, $MinBase, 10, 50);
            }
            if ($Number !== '') {
                $Number = base_convert($Number, $MinBase, 10);
            }
        }

        if ($Fraction === '') {
            return $Number === '' ? '0' : $Number;
        }
        return $Number === '' ? '0.' . $Fraction : $Number . '.' . $Fraction;
    }

    /**
     * Guards for the upper and lower limits of the current conversion set.
     *
     * @param mixed $Number The number to check.
     * @return bool True when outside the upper or lower limits.
     */
    public function limits($Number): bool
    {
        /** Can't check non-numeric values; Assume as okay. */
        if (!is_numeric($Number)) {
            return false;
        }

        $CSet = $this->{$this->ConversionSet};

        /** Upper limit guard. */
        if (isset($CSet['UpperLimit'])) {
            if (is_float($CSet['UpperLimit']) && PHP_INT_MAX > $CSet['UpperLimit']) {
                $CSet['UpperLimit'] = (int)$CSet['UpperLimit'];
            }
            if ($Number > $CSet['UpperLimit']) {
                return true;
            }
        }

        /** Lower limit guard. */
        if (isset($CSet['LowerLimit'])) {
            if (is_float($CSet['LowerLimit']) && PHP_INT_MIN < $CSet['LowerLimit']) {
                $CSet['LowerLimit'] = (int)$CSet['LowerLimit'];
            }
            if ($Number < $CSet['LowerLimit']) {
                return true;
            }
        }

        return false;
    }

    /**
     * Prepare to convert a fraction.
     *
     * @param string $Fraction The fraction to convert.
     * @param int $From The base to convert from.
     * @param int $To The base to convert to.
     * @param int $Limit Maximum number of places permitted.
     * @return string The converted fraction, or an empty string on failure.
     */
    private function convertFraction(string $Fraction = '', int $From = 10, int $To = 10, int $Limit = 8): string
    {
        if ($From < 2 || $To < 2 || $From > 36 || $To > 36 || $Limit < 1) {
            return '';
        }
        $FracLen = strlen($Fraction);
        if ($From === $To || $FracLen < 1) {
            return $Fraction;
        }
        $Fraction = rtrim($Fraction, '0');
        if ($From !== 10) {
            $PreFloat = [];
            for ($Index = 0; $Index < $FracLen; $Index++) {
                $PreFloat[$Index] = substr($Fraction, $Index, 1);
                if (isset($this->Symbols[$PreFloat[$Index]])) {
                    $PreFloat[$Index] = $this->Symbols[$PreFloat[$Index]];
                }
                $PreFloat[$Index] = ((int)$PreFloat[$Index] / $From) * 10;
                while ($PreFloat[$Index] >= 10) {
                    $Lookback = $Index;
                    while ($PreFloat[$Lookback] >= 10) {
                        $PreFloat[$Lookback] -= 10;
                        if (isset($PreFloat[$Lookback])) {
                            $Lookback--;
                            $PreFloat[$Lookback]++;
                        }
                    }
                }
            }
            $Float = implode('', $PreFloat);
        }
        $Float = (float)('0.' . $Fraction);
        $Sum = 0;
        $Degree = 0;
        while ($Degree < $this->MaxDegrees) {
            $Sum += $Float;
            $Degree++;
            if ($Sum > 0 && strpos($Sum, '.') === false) {
                break;
            }
        }
        $Ratio = $To / $Degree;
        $Try = $Sum * $Ratio;
        $Arr = [];
        $Index = 0;
        while ($Try > 0 && $Index < $Limit) {
            $Digit = floor($Try);
            $Try = ($Try - $Digit) * $To;
            $Arr[$Index] = $Digit;
            if (isset($this->Symbols[$Arr[$Index]])) {
                $Arr[$Index] = $this->Symbols[$Arr[$Index]];
            }
            if (strlen($Arr[$Index]) > 1) {
                $Arr[$Index] = 0;
            }
            $Index++;
        }
        return implode('', $Arr);
    }
}
